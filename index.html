<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <title>GUERRERO GYM</title>
</head>
<script>
    function id(el){
        return document.getElementById(el);
};

function ValidaValores(idCampo){
    console.log(idCampo);
        id(idCampo).onkeyup = function(){
            var v = this.value,
                integer = v.split('.')[0];

            v = v.replace(/\D/, "");
            v = v.replace(/^[0]+/, "");

            if (idCampo === 'peso'){
                //v = v.replace(/^(\d{1,3}(?:\.\d{0,2})?)$/, '$1');
                let valor = v.replace(/\D/g, '');

                // Limita a quantidade de dígitos antes e após a vírgula
                if (valor.length > 5) {
                  valor = valor.slice(0, 5);
                }
            
                // Adiciona a vírgula se houver mais de 1 dígito
                if (valor.length > 3) {
                  valor = valor.slice(0, 3) + '.' + valor.slice(3);
                }
            
                // Atualiza o valor do input
                v = valor.replace(",",".");

                v = v.length > 5 ? '' : v;
            }
            else
                v = v.length > 3 ? '' : v;

            this.value = v;
        }
};

function habilitaQuadril() {
    var sexo = document.getElementById("sexo").value;
    document.getElementById("divQuadril").hidden = sexo == "feminino" ? false : true;
    
    if(!document.getElementById("divQuadril").hidden) 
        document.getElementById("quadril").setAttribute("required", "true");
};

function calcularGorduraCorporal() {
  // Fórmula para calcular a gordura corporal para homens
  // Gordura corporal (%) = 86.010 × log10(cintura - pescoco) - 70.041 × log10(altura) + 36.76
  // Fórmula para calcular a gordura corporal para mulheres
  // Gordura corporal (%) = 163.205 × log10(cintura + quadril - pescoco) - 97.684 × log10(altura) - 78.387

let gorduraCorporal; 
let altura = document.getElementById("altura").value; 
let peso = document.getElementById("peso").value; 
let cintura = document.getElementById("cintura").value;
let pescoco = document.getElementById("pescoco").value;
let sexo = document.getElementById("sexo").value;
let quadril = document.getElementById("quadril").value;

if(altura != '' && peso != '' && cintura != '' && pescoco != '' && sexo != ''){
    if(document.getElementById("divQuadril").hidden === false){
        if(quadril === ''){
            alert('Medida do quadril não preenchida'); 
            return;
        }
    }
}

if (sexo.toLowerCase() === 'masculino') {
    gorduraCorporal = 86.010 * Math.log10(cintura - pescoco) - 70.041 * Math.log10(altura) + 36.76;
} else if (sexo.toLowerCase() === 'feminino') {
    gorduraCorporal = 163.205 * Math.log10(cintura + quadril - pescoco) - 97.684 * Math.log10(altura) - 78.387;
}

  alert("Resultado: " + gorduraCorporal.toFixed(2).toString()); // Retornando o valor da gordura corporal com duas casas decimais
}


</script>

    <body class="container">
      <div class="container-form">
        <div class="form-group">
            <div>
                <h2 class="display-4 text-muted"> Cálculo de porcentagem de gordura </h2>
                <small class="form-text text-muted"> Suas informações não serão compartilhadas. </small>
            </div>
            <div>
                <small style="color: chocolate;"> Sugestão: Utilizar fita métrica para medições. </small>
            </div>
        </div>
        <form>
            <div class="form-group">
                <label>Sexo:</label>
                <select class="form-control" id="sexo" required="true" onchange="habilitaQuadril()">
                    <option value="" selected="true" ></option>
                    <option value="feminino">Feminino</option>
                    <option value="masculino">Masculino</option>
                </select>
                <small class="form-text text-muted"> Insira o sexo que para melhor precisão no cálculo. </small>
            </div>
            <div id="divPeso" class="form-group">
                <label>Peso:</label>
                <input class="form-control" id="peso" placeholder="Insira seu peso (80.4kg)" required="true" onpointerleave="ValidaValores(this.id)" />
            </div>
            <div id="divAltura" class="form-group">
                <label>Altura:</label>
                <input class="form-control" id="altura" placeholder="Insira sua altura (1.75m = 175cm)" required="true" onpointerleave="ValidaValores(this.id)" />
            </div>
            <div id="divPescoco" class="form-group">
                <label>Pescoço:</label>
                <input class="form-control" id="pescoco" placeholder="Insira o tamanho do seu pescoço (40cm)" required="true" onpointerleave="ValidaValores(this.id)"/>
            </div>
            <div id="divCintura" class="form-group">
                <label>Cintura:</label>
                <input class="form-control" id="cintura" placeholder="Insira a circunferência de sua cintura (70cm)" required="true" onpointerleave="ValidaValores(this.id)"/>
            </div>
            <div id="divQuadril" class="form-group" hidden="true">
                <label>Quadril:</label>
                <input class="form-control" id="quadril" placeholder="Insira a circunferência do seu quadril (80cm)" onpointerleave="ValidaValores(this.id)"/>
                <small class="form-text text-muted">Apenas para o sexo feminino*</small>
            </div>
            <button type="submit" class="btn btn-success" onclick="calcularGorduraCorporal()"> Calcular </button>
        </form>
      </div>
    </body>
</html>
